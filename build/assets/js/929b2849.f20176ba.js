"use strict";(globalThis.webpackChunkdocs_site=globalThis.webpackChunkdocs_site||[]).push([[2420],{8453(e,n,t){t.d(n,{R:()=>i,x:()=>a});var s=t(6540);const r={},o=s.createContext(r);function i(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(o.Provider,{value:n},e.children)}},8869(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"sdk/tools","title":"Tools","description":"Building custom tools for STELLA agents","source":"@site/docs/sdk/tools.md","sourceDirName":"sdk","slug":"/sdk/tools","permalink":"/STELLA_backend/docs/sdk/tools","draft":false,"unlisted":false,"editUrl":"https://github.com/c4dhi/STELLA_backend/tree/main/docs-site/docs/sdk/tools.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Tools","description":"Building custom tools for STELLA agents"},"sidebar":"docsSidebar","previous":{"title":"Message Types","permalink":"/STELLA_backend/docs/sdk/message-types"},"next":{"title":"Streaming","permalink":"/STELLA_backend/docs/sdk/streaming"}}');var r=t(4848),o=t(8453);const i={sidebar_position:4,title:"Tools",description:"Building custom tools for STELLA agents"},a="Tools",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Creating Tools",id:"creating-tools",level:2},{value:"Basic Tool",id:"basic-tool",level:3},{value:"Tool with Multiple Parameters",id:"tool-with-multiple-parameters",level:3},{value:"Registering Tools",id:"registering-tools",level:2},{value:"In Agent Constructor",id:"in-agent-constructor",level:3},{value:"From a Module",id:"from-a-module",level:3},{value:"Executing Tools",id:"executing-tools",level:2},{value:"With OpenAI",id:"with-openai",level:3},{value:"Advanced Patterns",id:"advanced-patterns",level:2},{value:"Tool with Side Effects",id:"tool-with-side-effects",level:3},{value:"Tool with Database Access",id:"tool-with-database-access",level:3},{value:"Tool with Validation",id:"tool-with-validation",level:3},{value:"Parallel Tool Execution",id:"parallel-tool-execution",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Graceful Error Returns",id:"graceful-error-returns",level:3},{value:"Timeout Handling",id:"timeout-handling",level:3},{value:"Testing Tools",id:"testing-tools",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"tools",children:"Tools"})}),"\n",(0,r.jsx)(n.p,{children:"Tools extend agent capabilities by allowing them to perform actions beyond conversation. This guide covers creating, registering, and executing tools."}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"Tools are async Python functions that:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Have typed parameters with descriptions"}),"\n",(0,r.jsx)(n.li,{children:"Return structured results"}),"\n",(0,r.jsx)(n.li,{children:"Are automatically converted to OpenAI tool schemas"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"creating-tools",children:"Creating Tools"}),"\n",(0,r.jsx)(n.h3,{id:"basic-tool",children:"Basic Tool"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from stella_sdk import tool\n\n\n@tool\nasync def get_weather(city: str) -> dict:\n    """Get the current weather for a city.\n\n    Args:\n        city: The city name to get weather for\n\n    Returns:\n        Weather data including temperature and conditions\n    """\n    # Call weather API\n    response = await weather_api.get(city)\n\n    return {\n        "temperature": response.temp,\n        "conditions": response.conditions,\n        "humidity": response.humidity\n    }\n'})}),"\n",(0,r.jsx)(n.h3,{id:"tool-with-multiple-parameters",children:"Tool with Multiple Parameters"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'@tool\nasync def search_products(\n    query: str,\n    category: str = None,\n    max_results: int = 10,\n    min_price: float = None,\n    max_price: float = None\n) -> dict:\n    """Search for products in the catalog.\n\n    Args:\n        query: Search query\n        category: Optional category filter\n        max_results: Maximum number of results (default: 10)\n        min_price: Minimum price filter\n        max_price: Maximum price filter\n\n    Returns:\n        List of matching products\n    """\n    products = await catalog.search(\n        query=query,\n        category=category,\n        limit=max_results,\n        price_range=(min_price, max_price)\n    )\n\n    return {\n        "count": len(products),\n        "products": [\n            {"id": p.id, "name": p.name, "price": p.price}\n            for p in products\n        ]\n    }\n'})}),"\n",(0,r.jsx)(n.h2,{id:"registering-tools",children:"Registering Tools"}),"\n",(0,r.jsx)(n.h3,{id:"in-agent-constructor",children:"In Agent Constructor"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class MyAgent(BaseAgent):\n    def __init__(self):\n        super().__init__()\n\n        # Register tools\n        self.register_tool(get_weather)\n        self.register_tool(search_products)\n        self.register_tool(create_order)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"from-a-module",children:"From a Module"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# tools/__init__.py\nfrom .weather import get_weather\nfrom .products import search_products, create_order\n\nALL_TOOLS = [get_weather, search_products, create_order]\n\n# agent.py\nfrom tools import ALL_TOOLS\n\nclass MyAgent(BaseAgent):\n    def __init__(self):\n        super().__init__()\n        for tool in ALL_TOOLS:\n            self.register_tool(tool)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"executing-tools",children:"Executing Tools"}),"\n",(0,r.jsx)(n.h3,{id:"with-openai",children:"With OpenAI"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'async def generate_response(self, user_input: str) -> str:\n    messages = [\n        {"role": "system", "content": self.system_prompt},\n        *self.history,\n        {"role": "user", "content": user_input}\n    ]\n\n    # Get tool definitions\n    tools = self.get_tool_definitions()\n\n    # First LLM call\n    response = await self.openai.chat.completions.create(\n        model="gpt-4o",\n        messages=messages,\n        tools=tools\n    )\n\n    # Handle tool calls\n    while response.choices[0].message.tool_calls:\n        tool_calls = response.choices[0].message.tool_calls\n        messages.append(response.choices[0].message)\n\n        for tool_call in tool_calls:\n            name = tool_call.function.name\n            args = json.loads(tool_call.function.arguments)\n\n            # Show status\n            await self.send_status("thinking", f"Running {name}...")\n\n            # Execute\n            result = await self.execute_tool(name, args)\n\n            # Add result to messages\n            messages.append({\n                "role": "tool",\n                "tool_call_id": tool_call.id,\n                "content": json.dumps(result)\n            })\n\n        # Next LLM call with tool results\n        response = await self.openai.chat.completions.create(\n            model="gpt-4o",\n            messages=messages,\n            tools=tools\n        )\n\n    return response.choices[0].message.content\n'})}),"\n",(0,r.jsx)(n.h2,{id:"advanced-patterns",children:"Advanced Patterns"}),"\n",(0,r.jsx)(n.h3,{id:"tool-with-side-effects",children:"Tool with Side Effects"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'@tool\nasync def send_email(\n    to: str,\n    subject: str,\n    body: str,\n    cc: str = None\n) -> dict:\n    """Send an email to the specified recipient.\n\n    Args:\n        to: Recipient email address\n        subject: Email subject\n        body: Email body content\n        cc: Optional CC recipient\n\n    Returns:\n        Confirmation with message ID\n    """\n    try:\n        result = await email_service.send(\n            to=to,\n            subject=subject,\n            body=body,\n            cc=cc\n        )\n        return {\n            "success": True,\n            "message_id": result.id,\n            "message": f"Email sent to {to}"\n        }\n    except EmailError as e:\n        return {\n            "success": False,\n            "error": str(e)\n        }\n'})}),"\n",(0,r.jsx)(n.h3,{id:"tool-with-database-access",children:"Tool with Database Access"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'@tool\nasync def create_ticket(\n    title: str,\n    description: str,\n    priority: str = "medium",\n    assignee: str = None\n) -> dict:\n    """Create a support ticket in the system.\n\n    Args:\n        title: Brief ticket title\n        description: Detailed description\n        priority: low, medium, or high\n        assignee: Optional assignee email\n\n    Returns:\n        Created ticket details\n    """\n    ticket = await db.tickets.create(\n        title=title,\n        description=description,\n        priority=priority,\n        assignee=assignee,\n        status="open",\n        created_at=datetime.utcnow()\n    )\n\n    # Notify assignee if specified\n    if assignee:\n        await notify_assignee(ticket, assignee)\n\n    return {\n        "ticket_id": ticket.id,\n        "url": f"https://support.example.com/tickets/{ticket.id}",\n        "status": "created"\n    }\n'})}),"\n",(0,r.jsx)(n.h3,{id:"tool-with-validation",children:"Tool with Validation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from pydantic import BaseModel, validator\n\nclass OrderInput(BaseModel):\n    product_id: str\n    quantity: int\n    shipping_address: str\n\n    @validator(\'quantity\')\n    def quantity_positive(cls, v):\n        if v <= 0:\n            raise ValueError(\'Quantity must be positive\')\n        return v\n\n\n@tool\nasync def place_order(\n    product_id: str,\n    quantity: int,\n    shipping_address: str\n) -> dict:\n    """Place an order for a product.\n\n    Args:\n        product_id: Product identifier\n        quantity: Number of items (must be positive)\n        shipping_address: Delivery address\n\n    Returns:\n        Order confirmation\n    """\n    # Validate input\n    try:\n        validated = OrderInput(\n            product_id=product_id,\n            quantity=quantity,\n            shipping_address=shipping_address\n        )\n    except ValueError as e:\n        return {"success": False, "error": str(e)}\n\n    # Process order\n    order = await orders.create(\n        product_id=validated.product_id,\n        quantity=validated.quantity,\n        address=validated.shipping_address\n    )\n\n    return {\n        "success": True,\n        "order_id": order.id,\n        "estimated_delivery": order.estimated_delivery.isoformat()\n    }\n'})}),"\n",(0,r.jsx)(n.h3,{id:"parallel-tool-execution",children:"Parallel Tool Execution"}),"\n",(0,r.jsx)(n.p,{children:"When the LLM requests multiple tools, execute them in parallel:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'async def execute_tools_parallel(self, tool_calls):\n    tasks = []\n    for tool_call in tool_calls:\n        name = tool_call.function.name\n        args = json.loads(tool_call.function.arguments)\n        tasks.append(self.execute_tool(name, args))\n\n    results = await asyncio.gather(*tasks)\n\n    return [\n        {\n            "role": "tool",\n            "tool_call_id": tool_call.id,\n            "content": json.dumps(result)\n        }\n        for tool_call, result in zip(tool_calls, results)\n    ]\n'})}),"\n",(0,r.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsx)(n.h3,{id:"graceful-error-returns",children:"Graceful Error Returns"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'@tool\nasync def risky_operation(param: str) -> dict:\n    """Perform an operation that might fail."""\n    try:\n        result = await external_service.call(param)\n        return {"success": True, "data": result}\n    except ServiceError as e:\n        # Return error for LLM to handle\n        return {\n            "success": False,\n            "error": str(e),\n            "suggestion": "Try again with different parameters"\n        }\n'})}),"\n",(0,r.jsx)(n.h3,{id:"timeout-handling",children:"Timeout Handling"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import asyncio\n\n@tool\nasync def slow_operation(query: str) -> dict:\n    """Operation with timeout."""\n    try:\n        result = await asyncio.wait_for(\n            external_api.call(query),\n            timeout=30.0\n        )\n        return {"success": True, "data": result}\n    except asyncio.TimeoutError:\n        return {\n            "success": False,\n            "error": "Operation timed out",\n            "suggestion": "Try a simpler query"\n        }\n'})}),"\n",(0,r.jsx)(n.h2,{id:"testing-tools",children:"Testing Tools"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import pytest\nfrom unittest.mock import AsyncMock\n\n@pytest.mark.asyncio\nasync def test_get_weather():\n    # Mock the API\n    with patch(\'tools.weather_api\') as mock_api:\n        mock_api.get = AsyncMock(return_value=MockResponse(\n            temp=72,\n            conditions="sunny",\n            humidity=45\n        ))\n\n        result = await get_weather("San Francisco")\n\n        assert result["temperature"] == 72\n        assert result["conditions"] == "sunny"\n        mock_api.get.assert_called_once_with("San Francisco")\n'})}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/guides/custom-tools",children:"Custom Tools Guide"})," - Step-by-step guide to creating tools"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/sdk/streaming",children:"Streaming"})," - Audio streaming"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/sdk/base-agent",children:"Base Agent"})," - Full API reference"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/guides/build-your-own-agent",children:"Build Your Own Agent"})," - Complete tutorial"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);