"use strict";(globalThis.webpackChunkdocs_site=globalThis.webpackChunkdocs_site||[]).push([[8595],{8453(e,s,n){n.d(s,{R:()=>l,x:()=>d});var i=n(6540);const r={},t=i.createContext(r);function l(e){const s=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:s},e.children)}},9452(e,s,n){n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"deployment/message-recording","title":"Message Recording","description":"STELLA includes a message recording system that silently captures all session messages for history retrieval and persistence.","source":"@site/docs/deployment/message-recording.md","sourceDirName":"deployment","slug":"/deployment/message-recording","permalink":"/STELLA_backend/docs/deployment/message-recording","draft":false,"unlisted":false,"editUrl":"https://github.com/c4dhi/STELLA_backend/tree/main/docs-site/docs/deployment/message-recording.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Message Recording"},"sidebar":"docsSidebar","previous":{"title":"Nginx Setup","permalink":"/STELLA_backend/docs/deployment/nginx-setup"},"next":{"title":"Production Checklist","permalink":"/STELLA_backend/docs/deployment/production-checklist"}}');var r=n(4848),t=n(8453);const l={sidebar_position:4,title:"Message Recording"},d="Message Recording & History",a={},c=[{value:"Overview",id:"overview",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Components",id:"components",level:2},{value:"Backend",id:"backend",level:3},{value:"Frontend",id:"frontend",level:3},{value:"Database Schema",id:"database-schema",level:2},{value:"API Endpoints",id:"api-endpoints",level:2},{value:"Get Session Messages",id:"get-session-messages",level:3},{value:"Get Latest Messages",id:"get-latest-messages",level:3},{value:"Message Filtering",id:"message-filtering",level:2},{value:"Recorded",id:"recorded",level:3},{value:"Skipped",id:"skipped",level:3},{value:"Deployment",id:"deployment",level:2},{value:"Step 1: Install Dependencies",id:"step-1-install-dependencies",level:3},{value:"Step 2: Generate Prisma Client",id:"step-2-generate-prisma-client",level:3},{value:"Step 3: Run Database Migration",id:"step-3-run-database-migration",level:3},{value:"Step 4: Restart Backend",id:"step-4-restart-backend",level:3},{value:"Step 5: Rebuild Frontend",id:"step-5-rebuild-frontend",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Monitoring Behavior",id:"monitoring-behavior",level:2},{value:"Performance",id:"performance",level:2},{value:"Database",id:"database",level:3},{value:"Frontend",id:"frontend-1",level:3},{value:"Backend",id:"backend-1",level:3},{value:"Verification Checklist",id:"verification-checklist",level:2},{value:"Backend",id:"backend-2",level:3},{value:"Frontend",id:"frontend-2",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Messages Not Being Recorded",id:"messages-not-being-recorded",level:3},{value:"Frontend Not Loading History",id:"frontend-not-loading-history",level:3},{value:"Duplicate Messages in UI",id:"duplicate-messages-in-ui",level:3},{value:"Future Enhancements",id:"future-enhancements",level:2},{value:"See Also",id:"see-also",level:2}];function o(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"message-recording--history",children:"Message Recording & History"})}),"\n",(0,r.jsx)(s.p,{children:"STELLA includes a message recording system that silently captures all session messages for history retrieval and persistence."}),"\n",(0,r.jsx)(s.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(s.p,{children:"The system provides:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Silent recording"})," - Backend automatically records all sessions"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Full history"})," - Users see complete conversation when entering a session"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Real-time merge"})," - New messages seamlessly append to history"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Infinite scroll"})," - Older messages load automatically"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Production-ready"})," - Handles failures, reconnections, and edge cases"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"architecture",children:"Architecture"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    LiveKit Server                           \u2502\n\u2502  Room: session-123    Room: session-456                     \u2502\n\u2502    \u251c\u2500\u2500 Agent           \u251c\u2500\u2500 Agent                            \u2502\n\u2502    \u251c\u2500\u2500 User            \u2514\u2500\u2500 User                             \u2502\n\u2502    \u2514\u2500\u2500 Monitor (message-recorder)                           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                    \u25b2                \u25b2\n                    \u2502                \u2502\n          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n          \u2502                  \u2502             \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502             \u2502\n\u2502 Room Monitor      \u2502       \u2502             \u2502\n\u2502 Service (NestJS)  \u2502       \u2502             \u2502\n\u2502 \u2022 Auto-joins      \u2502       \u2502             \u2502\n\u2502 \u2022 Silent listener \u2502       \u2502             \u2502\n\u2502 \u2022 Filters finals  \u2502       \u2502             \u2502\n\u2502 \u2022 Persists to DB  \u2502       \u2502             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2502             \u2502\n          \u2502                  \u2502             \u2502\n          \u25bc                  \u2502             \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502             \u2502\n\u2502   PostgreSQL    \u2502         \u2502             \u2502\n\u2502   (Messages)    \u2502         \u2502             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502             \u2502\n          \u2502                  \u2502             \u2502\n          \u25bc                  \u2502             \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502             \u2502\n\u2502  REST API       \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518             \u2502\n\u2502  /messages      \u2502                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2502\n        \u2502                                  \u2502\n        \u25bc                                  \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                       \u2502\n\u2502  Frontend       \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u2502  ChatView       \u2502    (Real-time msgs)\n\u2502 \u2022 Load history  \u2502\n\u2502 \u2022 Merge realtime\u2502\n\u2502 \u2022 Infinite scroll\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(s.h2,{id:"components",children:"Components"}),"\n",(0,r.jsx)(s.h3,{id:"backend",children:"Backend"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Component"}),(0,r.jsx)(s.th,{children:"Location"}),(0,r.jsx)(s.th,{children:"Purpose"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"RoomMonitorService"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"src/message-recorder/room-monitor.service.ts"})}),(0,r.jsx)(s.td,{children:"Silently joins LiveKit rooms"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"MessageRecorderService"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"src/message-recorder/message-recorder.service.ts"})}),(0,r.jsx)(s.td,{children:"Persists messages to PostgreSQL"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Message API"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"src/sessions/sessions.controller.ts"})}),(0,r.jsx)(s.td,{children:"REST endpoints for history"})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"frontend",children:"Frontend"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Component"}),(0,r.jsx)(s.th,{children:"Location"}),(0,r.jsx)(s.th,{children:"Purpose"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"ApiClient"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"src/services/ApiClient.ts"})}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"getSessionMessages()"}),", ",(0,r.jsx)(s.code,{children:"getLatestMessages()"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Store"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"src/store/index.ts"})}),(0,r.jsx)(s.td,{children:"Historical message state management"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"ChatView"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"src/components/ChatView.tsx"})}),(0,r.jsx)(s.td,{children:"Merges historical + real-time messages"})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"database-schema",children:"Database Schema"}),"\n",(0,r.jsxs)(s.p,{children:["Enhanced Message model in ",(0,r.jsx)(s.code,{children:"prisma/schema.prisma"}),". See ",(0,r.jsx)(s.a,{href:"/docs/architecture/database",children:"Database Schema"})," for the complete data model."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-prisma",children:"model Message {\n  id          String   @id @default(uuid())\n  sessionId   String\n  content     String\n  role        String   // user, assistant, system\n  status      String?  // pending, complete\n  metadata    Json?    // Additional message data\n  timestamp   DateTime @default(now())\n  createdAt   DateTime @default(now())\n\n  session     Session  @relation(fields: [sessionId], references: [id])\n\n  @@index([sessionId, timestamp])\n}\n"})}),"\n",(0,r.jsx)(s.h2,{id:"api-endpoints",children:"API Endpoints"}),"\n",(0,r.jsx)(s.h3,{id:"get-session-messages",children:"Get Session Messages"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"GET /sessions/:sessionId/messages?cursor=<id>&limit=50\n"})}),"\n",(0,r.jsx)(s.p,{children:"Returns cursor-based paginated messages."}),"\n",(0,r.jsx)(s.h3,{id:"get-latest-messages",children:"Get Latest Messages"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"GET /sessions/:sessionId/messages/latest?since=<timestamp>\n"})}),"\n",(0,r.jsx)(s.p,{children:"Returns messages since a specific timestamp for real-time sync."}),"\n",(0,r.jsx)(s.h2,{id:"message-filtering",children:"Message Filtering"}),"\n",(0,r.jsx)(s.h3,{id:"recorded",children:"Recorded"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Final transcripts (",(0,r.jsx)(s.code,{children:"is_final: true"}),")"]}),"\n",(0,r.jsxs)(s.li,{children:["Task list updates (",(0,r.jsx)(s.code,{children:"complete_todo_list"}),")"]}),"\n",(0,r.jsxs)(s.li,{children:["Deliverables (",(0,r.jsx)(s.code,{children:"plan_deliverable_update"}),")"]}),"\n",(0,r.jsxs)(s.li,{children:["State changes (",(0,r.jsx)(s.code,{children:"state_change_notification"}),")"]}),"\n",(0,r.jsx)(s.li,{children:"Participant events (join/leave)"}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"skipped",children:"Skipped"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Partial transcripts"}),"\n",(0,r.jsx)(s.li,{children:"TTS control messages"}),"\n",(0,r.jsx)(s.li,{children:"Audio stream chunks"}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"deployment",children:"Deployment"}),"\n",(0,r.jsx)(s.h3,{id:"step-1-install-dependencies",children:"Step 1: Install Dependencies"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"npm install\n"})}),"\n",(0,r.jsx)(s.h3,{id:"step-2-generate-prisma-client",children:"Step 2: Generate Prisma Client"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"npx prisma generate\n"})}),"\n",(0,r.jsx)(s.h3,{id:"step-3-run-database-migration",children:"Step 3: Run Database Migration"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"npx prisma migrate dev --name enhance_message_model\n"})}),"\n",(0,r.jsx)(s.h3,{id:"step-4-restart-backend",children:"Step 4: Restart Backend"}),"\n",(0,r.jsx)(s.p,{children:"The Room Monitor Service will automatically:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Start monitoring all ACTIVE sessions on startup"}),"\n",(0,r.jsx)(s.li,{children:"Begin recording messages immediately"}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"npm run start:dev\n"})}),"\n",(0,r.jsx)(s.p,{children:"Verify in logs:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"[RoomMonitorService] Room Monitor Service initializing...\n[RoomMonitorService] Found X active sessions to monitor\n[RoomMonitorService] Successfully connected to room session-...\n"})}),"\n",(0,r.jsx)(s.h3,{id:"step-5-rebuild-frontend",children:"Step 5: Rebuild Frontend"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"cd frontend-ui\nnpm run build  # production\n# OR\nnpm run dev    # development\n"})}),"\n",(0,r.jsx)(s.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(s.p,{children:"No new environment variables required. The system uses existing LiveKit configuration:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-env",children:"LIVEKIT_URL=ws://livekit:7880\nLIVEKIT_API_KEY=devkey\nLIVEKIT_API_SECRET=secret\nDATABASE_URL=postgresql://...\n"})}),"\n",(0,r.jsx)(s.h2,{id:"monitoring-behavior",children:"Monitoring Behavior"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Feature"}),(0,r.jsx)(s.th,{children:"Behavior"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Auto-start"}),(0,r.jsx)(s.td,{children:"Joins all ACTIVE sessions on app boot"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Auto-reconnect"}),(0,r.jsx)(s.td,{children:"5 retry attempts with exponential backoff"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Auto-stop"}),(0,r.jsx)(s.td,{children:"Disconnects when session is closed"})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"performance",children:"Performance"}),"\n",(0,r.jsx)(s.h3,{id:"database",children:"Database"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Indexes"}),": Optimized for ",(0,r.jsx)(s.code,{children:"sessionId + timestamp"})," queries"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Storage"}),": ~2.5MB per 1000 messages"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Query time"}),": Under 50ms for 50 messages with proper indexes"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"frontend-1",children:"Frontend"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Initial load"}),": 50 messages (configurable)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Pagination"}),": 50 messages per scroll"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Deduplication"}),": O(n) using Map"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Re-renders"}),": Optimized with useMemo"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"backend-1",children:"Backend"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Connection per session"}),": One silent LiveKit connection"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Memory usage"}),": ~5MB per monitored room"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Scalability"}),": Tested with 100+ parallel sessions"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"verification-checklist",children:"Verification Checklist"}),"\n",(0,r.jsx)(s.h3,{id:"backend-2",children:"Backend"}),"\n",(0,r.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Database migration completed successfully"]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Room Monitor Service starts without errors"]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Messages are being recorded:"]}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:'SELECT * FROM "Message" ORDER BY "timestamp" DESC LIMIT 10;\n'})}),"\n",(0,r.jsx)(s.h3,{id:"frontend-2",children:"Frontend"}),"\n",(0,r.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Opening a session loads historical messages"]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Scrolling to top loads more messages (if >50 exist)"]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","New real-time messages append to the bottom"]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","No duplicate messages in the UI"]}),"\n",(0,r.jsxs)(s.li,{className:"task-list-item",children:[(0,r.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Loading indicators appear during fetch"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(s.h3,{id:"messages-not-being-recorded",children:"Messages Not Being Recorded"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Check Room Monitor Service logs:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'grep "RoomMonitorService" logs/\n'})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Verify the service is monitoring the session:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"curl http://localhost:3000/monitoring/stats\n"})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Check database connectivity:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"npx prisma studio\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"frontend-not-loading-history",children:"Frontend Not Loading History"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"Open browser DevTools \u2192 Network tab"}),"\n",(0,r.jsxs)(s.li,{children:["Look for failed ",(0,r.jsx)(s.code,{children:"/sessions/:id/messages"})," requests"]}),"\n",(0,r.jsxs)(s.li,{children:["Verify API endpoint is accessible:","\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"curl http://localhost:3000/sessions/SESSION_ID/messages\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"duplicate-messages-in-ui",children:"Duplicate Messages in UI"}),"\n",(0,r.jsx)(s.p,{children:"This should not happen (deduplication by ID), but if it does:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Check for duplicate IDs in database:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:'SELECT id, COUNT(*) FROM "Message" GROUP BY id HAVING COUNT(*) > 1;\n'})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Verify deduplication logic in ChatView.tsx"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"future-enhancements",children:"Future Enhancements"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Message search"}),": Full-text search across historical messages"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Export"}),": Download conversation history as JSON/PDF"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Filters"}),": Filter by message type, participant, date range"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Analytics"}),": Message statistics and conversation insights"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Compression"}),": Archive old messages to reduce database size"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"see-also",children:"See Also"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.a,{href:"/docs/architecture/database",children:"Database Schema"})," - Complete data model"]}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/docs/architecture/session-lifecycle",children:"Session Lifecycle"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/docs/integration/livekit",children:"LiveKit Integration"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/docs/integration/frontend",children:"Frontend Integration"})}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}}}]);