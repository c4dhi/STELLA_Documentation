"use strict";(globalThis.webpackChunkdocs_site=globalThis.webpackChunkdocs_site||[]).push([[3478],{2076(e,i,s){s.d(i,{gj:()=>a,pn:()=>r});s(6540);var n=s(7714),t=s(4848);function r({number:e,title:i,children:s,code:r,language:a="bash",isLast:l=!1}){return(0,t.jsxs)("div",{className:"step",children:[(0,t.jsxs)("div",{className:"step__indicator",children:[(0,t.jsx)("div",{className:"step__number",children:e}),!l&&(0,t.jsx)("div",{className:"step__connector"})]}),(0,t.jsxs)("div",{className:"step__body",children:[(0,t.jsx)("h3",{className:"step__title",children:i}),(0,t.jsx)("div",{className:"step__content",children:s}),r&&(0,t.jsx)("div",{className:"step__code",children:(0,t.jsx)(n.A,{language:a,children:r})})]})]})}function a({children:e}){return(0,t.jsx)("div",{className:"steps",children:e})}},2285(e,i,s){s.r(i),s.d(i,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"guides/add-custom-ui","title":"Custom Agent Visualizers","description":"Create custom visual representations for your STELLA AI assistant","source":"@site/docs/guides/add-custom-ui.md","sourceDirName":"guides","slug":"/guides/add-custom-ui","permalink":"/STELLA_backend/docs/guides/add-custom-ui","draft":false,"unlisted":false,"editUrl":"https://github.com/c4dhi/STELLA_backend/tree/main/docs-site/docs/guides/add-custom-ui.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Custom Agent Visualizers","description":"Create custom visual representations for your STELLA AI assistant"},"sidebar":"docsSidebar","previous":{"title":"Custom Tools","permalink":"/STELLA_backend/docs/guides/custom-tools"},"next":{"title":"Authentication","permalink":"/STELLA_backend/docs/guides/authentication"}}');var t=s(4848),r=s(8453),a=s(2076);const l={sidebar_position:3,title:"Custom Agent Visualizers",description:"Create custom visual representations for your STELLA AI assistant"},o="Custom Agent Visualizers",c={},d=[{value:"What are Visualizers?",id:"what-are-visualizers",level:2},{value:"Architecture Overview",id:"architecture-overview",level:2},{value:"Core Interfaces",id:"core-interfaces",level:2},{value:"Adding a Custom Visualizer",id:"adding-a-custom-visualizer",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Audio Reactivity",id:"audio-reactivity",level:3},{value:"Performance",id:"performance",level:3},{value:"Responsive Sizing",id:"responsive-sizing",level:3},{value:"Using AudioReactiveSiriOrb",id:"using-audioreactivesiriorb",level:3},{value:"Existing Visualizers Reference",id:"existing-visualizers-reference",level:2},{value:"Next Steps",id:"next-steps",level:2}];function u(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.header,{children:(0,t.jsx)(i.h1,{id:"custom-agent-visualizers",children:"Custom Agent Visualizers"})}),"\n",(0,t.jsxs)(i.p,{children:["STELLA's visual interface is driven by ",(0,t.jsx)(i.strong,{children:"visualizers"})," - animated components that represent the AI assistant. Users can select from multiple visualizers in a gallery, and you can contribute your own custom visualizers to the system."]}),"\n",(0,t.jsx)(i.h2,{id:"what-are-visualizers",children:"What are Visualizers?"}),"\n",(0,t.jsx)(i.p,{children:'Visualizers are the animated "face" of the AI assistant. They respond to:'}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Audio levels"})," - Pulse, glow, or animate based on speech volume"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Speaking state"})," - Change appearance when the assistant is speaking vs listening"]}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"Built-in visualizers include animated faces, glowing orbs, and themed particle effects (galaxy, weather, etc.). The visualizer gallery lets users switch between them in real-time."}),"\n",(0,t.jsx)(i.h2,{id:"architecture-overview",children:"Architecture Overview"}),"\n",(0,t.jsx)(i.p,{children:"All visualizer code lives in the frontend:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-text",children:"frontend-ui/src/components/face/\n\u251c\u2500\u2500 types.ts                    # Type definitions and registry\n\u251c\u2500\u2500 VisualizerRenderer.tsx      # Component dispatcher (switch statement)\n\u251c\u2500\u2500 VisualizerGallery.tsx       # Selection UI panel\n\u251c\u2500\u2500 VisualizerPreview.tsx       # Gallery thumbnail previews\n\u251c\u2500\u2500 hooks/                      # Shared animation hooks\n\u2502   \u251c\u2500\u2500 useFaceAnimation.ts\n\u2502   \u251c\u2500\u2500 useFaceTracking.ts\n\u2502   \u2514\u2500\u2500 useMouthAnimation.ts\n\u2514\u2500\u2500 visualizers/                # Individual visualizer implementations\n    \u251c\u2500\u2500 SphereVisualizer.tsx\n    \u251c\u2500\u2500 WeatherVisualizer.tsx\n    \u251c\u2500\u2500 AudioReactiveSiriOrb.tsx\n    \u251c\u2500\u2500 SiriOrb.tsx\n    \u2514\u2500\u2500 useResponsiveSphereSize.ts\n"})}),"\n",(0,t.jsx)(i.h2,{id:"core-interfaces",children:"Core Interfaces"}),"\n",(0,t.jsxs)(i.p,{children:["All visualizers implement the same interface defined in ",(0,t.jsx)(i.code,{children:"types.ts"}),":"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-typescript",metastring:'title="types.ts"',children:"// Standard props all visualizers receive\nexport interface VisualizerProps {\n  audioLevel: number;        // 0.0 to 1.0 - current speech volume\n  isRemoteSpeaking: boolean; // true when assistant is speaking\n  isUserSpeaking?: boolean;  // true when user is speaking\n}\n\n// Registered visualizer types\nexport type VisualizerType =\n  | 'face'\n  | 'sphere'\n  | 'galaxy'\n  | 'rainy'\n  | 'snowy'\n  | 'christmas'\n  | 'sunny';\n\n// Configuration for gallery display\nexport interface VisualizerConfig {\n  id: VisualizerType;\n  name: string;           // Display name in gallery\n  description: string;    // Short description\n  previewBg: string;      // Tailwind background class for preview\n  checkmarkColor: string; // Selection indicator color\n}\n"})}),"\n",(0,t.jsx)(i.h2,{id:"adding-a-custom-visualizer",children:"Adding a Custom Visualizer"}),"\n",(0,t.jsxs)(a.gj,{children:[(0,t.jsxs)(a.pn,{number:1,title:"Add the type definition",children:[(0,t.jsxs)(i.p,{children:["In ",(0,t.jsx)(i.code,{children:"types.ts"}),", add your visualizer ID to the ",(0,t.jsx)(i.code,{children:"VisualizerType"})," union:"]}),(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-typescript",metastring:'title="types.ts"',children:"export type VisualizerType =\n  | 'face'\n  | 'sphere'\n  | 'galaxy'\n  | 'rainy'\n  | 'snowy'\n  | 'christmas'\n  | 'sunny'\n  | 'pulse'; // Your new visualizer\n"})})]}),(0,t.jsxs)(a.pn,{number:2,title:"Register the configuration",children:[(0,t.jsxs)(i.p,{children:["Add an entry to the ",(0,t.jsx)(i.code,{children:"VISUALIZER_CONFIGS"})," array in ",(0,t.jsx)(i.code,{children:"types.ts"}),":"]}),(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-typescript",metastring:'title="types.ts"',children:"export const VISUALIZER_CONFIGS: VisualizerConfig[] = [\n  // ... existing configs ...\n  {\n    id: 'pulse',\n    name: 'Pulse',\n    description: 'Pulsing rings',\n    previewBg: 'bg-gradient-to-br from-rose-950 via-pink-900 to-rose-800',\n    checkmarkColor: 'bg-rose-400',\n  },\n];\n"})})]}),(0,t.jsxs)(a.pn,{number:3,title:"Create the visualizer component",children:[(0,t.jsxs)(i.p,{children:["Create your visualizer in ",(0,t.jsx)(i.code,{children:"visualizers/PulseVisualizer.tsx"}),":"]}),(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-tsx",metastring:'title="visualizers/PulseVisualizer.tsx"',children:"import React, { useEffect, useState, useRef } from 'react';\nimport { motion } from 'framer-motion';\nimport { useResponsiveSphereSize } from './useResponsiveSphereSize';\n\ninterface PulseVisualizerProps {\n  audioLevel?: number;\n  isRemoteSpeaking?: boolean;\n}\n\nconst PulseVisualizer: React.FC<PulseVisualizerProps> = ({\n  audioLevel = 0,\n  isRemoteSpeaking = false,\n}) => {\n  const size = useResponsiveSphereSize(150, 300, 0.35);\n\n  // Smooth the audio level for fluid animations\n  const [smoothedAudio, setSmoothedAudio] = useState(0);\n  const audioRef = useRef(audioLevel);\n  audioRef.current = audioLevel;\n\n  useEffect(() => {\n    let animationId: number;\n\n    const animate = () => {\n      setSmoothedAudio(prev => {\n        const target = audioRef.current;\n        const factor = target > prev ? 0.3 : 0.1; // Fast attack, slow decay\n        return prev + (target - prev) * factor;\n      });\n      animationId = requestAnimationFrame(animate);\n    };\n\n    animationId = requestAnimationFrame(animate);\n    return () => cancelAnimationFrame(animationId);\n  }, []);\n\n  const ringCount = 3;\n  const baseScale = 1 + smoothedAudio * 0.3;\n\n  return (\n    <div className=\"relative w-full h-full flex items-center justify-center bg-gradient-to-br from-rose-950 via-pink-900 to-rose-800\">\n      {/* Concentric rings */}\n      {Array.from({ length: ringCount }).map((_, i) => (\n        <motion.div\n          key={i}\n          className=\"absolute rounded-full border-2 border-rose-400/40\"\n          style={{ width: size, height: size }}\n          animate={{\n            scale: baseScale + i * 0.2,\n            opacity: isRemoteSpeaking ? 0.8 - i * 0.2 : 0.3 - i * 0.1,\n          }}\n          transition={{ duration: 0.15 }}\n        />\n      ))}\n\n      {/* Center dot */}\n      <motion.div\n        className=\"rounded-full bg-rose-400\"\n        style={{ width: size * 0.15, height: size * 0.15 }}\n        animate={{\n          scale: 1 + smoothedAudio * 0.5,\n          boxShadow: isRemoteSpeaking\n            ? `0 0 ${30 + smoothedAudio * 40}px rgba(251, 113, 133, 0.6)`\n            : '0 0 20px rgba(251, 113, 133, 0.3)',\n        }}\n        transition={{ duration: 0.1 }}\n      />\n    </div>\n  );\n};\n\nexport default PulseVisualizer;\n"})})]}),(0,t.jsxs)(a.pn,{number:4,title:"Register in the renderer",children:[(0,t.jsxs)(i.p,{children:["Add your visualizer to the switch statement in ",(0,t.jsx)(i.code,{children:"VisualizerRenderer.tsx"}),":"]}),(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-tsx",metastring:'title="VisualizerRenderer.tsx"',children:"import PulseVisualizer from './visualizers/PulseVisualizer';\n\n// Inside the switch statement:\ncase 'pulse':\n  return (\n    <PulseVisualizer\n      audioLevel={audioLevel}\n      isRemoteSpeaking={isRemoteSpeaking}\n    />\n  );\n"})})]}),(0,t.jsxs)(a.pn,{number:5,title:"Add the gallery preview",isLast:!0,children:[(0,t.jsxs)(i.p,{children:["Add a preview case in ",(0,t.jsx)(i.code,{children:"VisualizerPreview.tsx"})," for the gallery thumbnail:"]}),(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-tsx",metastring:'title="VisualizerPreview.tsx"',children:"case 'pulse':\n  return (\n    <div className=\"absolute inset-0 flex items-center justify-center\">\n      {/* Concentric rings preview */}\n      {[0, 1, 2].map((i) => (\n        <div\n          key={i}\n          className=\"absolute rounded-full border border-rose-400/50\"\n          style={{\n            width: `${(isSmall ? 20 : 40) + i * (isSmall ? 8 : 16)}px`,\n            height: `${(isSmall ? 20 : 40) + i * (isSmall ? 8 : 16)}px`,\n          }}\n        />\n      ))}\n      {/* Center dot */}\n      <div className={`rounded-full bg-rose-400 ${isSmall ? 'w-2 h-2' : 'w-4 h-4'}`} />\n    </div>\n  );\n"})})]})]}),"\n",(0,t.jsx)(i.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsx)(i.h3,{id:"audio-reactivity",children:"Audio Reactivity"}),"\n",(0,t.jsx)(i.p,{children:"Smooth your audio levels to avoid jittery animations:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-typescript",children:"// Fast attack (0.3-0.4), slow decay (0.1-0.2) feels natural\nconst factor = target > current ? 0.35 : 0.12;\nconst smoothed = current + (target - current) * factor;\n"})}),"\n",(0,t.jsx)(i.p,{children:"For speaking state, add a hold time to prevent flickering:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-typescript",children:"// Hold speaking state for 500-800ms after speech stops\nconst SPEAKING_HOLD_MS = 600;\n\nuseEffect(() => {\n  if (isRemoteSpeaking) {\n    setIsSpeakingHeld(true);\n    clearTimeout(timeoutRef.current);\n  } else {\n    timeoutRef.current = setTimeout(() => {\n      setIsSpeakingHeld(false);\n    }, SPEAKING_HOLD_MS);\n  }\n}, [isRemoteSpeaking]);\n"})}),"\n",(0,t.jsx)(i.h3,{id:"performance",children:"Performance"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Use CSS transforms (",(0,t.jsx)(i.code,{children:"scale3d"}),", ",(0,t.jsx)(i.code,{children:"translateZ(0)"}),") for GPU acceleration"]}),"\n",(0,t.jsxs)(i.li,{children:["Set ",(0,t.jsx)(i.code,{children:"willChange: 'transform'"})," for frequently animated properties"]}),"\n",(0,t.jsxs)(i.li,{children:["Use ",(0,t.jsx)(i.code,{children:"requestAnimationFrame"})," for smooth continuous animations"]}),"\n",(0,t.jsxs)(i.li,{children:["Memoize expensive calculations with ",(0,t.jsx)(i.code,{children:"useMemo"})]}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:"responsive-sizing",children:"Responsive Sizing"}),"\n",(0,t.jsxs)(i.p,{children:["Use the ",(0,t.jsx)(i.code,{children:"useResponsiveSphereSize"})," hook to maintain proportions across screen sizes:"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-typescript",children:"import { useResponsiveSphereSize } from './useResponsiveSphereSize';\n\n// Parameters: minSize, maxSize, ratio (of viewport min dimension)\nconst size = useResponsiveSphereSize(200, 400, 0.38);\n"})}),"\n",(0,t.jsx)(i.h3,{id:"using-audioreactivesiriorb",children:"Using AudioReactiveSiriOrb"}),"\n",(0,t.jsxs)(i.p,{children:["For orb-style visualizers, extend the ",(0,t.jsx)(i.code,{children:"AudioReactiveSiriOrb"})," component:"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-tsx",children:'import AudioReactiveSiriOrb, { SIRI_ORB_THEMES } from \'./AudioReactiveSiriOrb\';\n\n// Add a custom theme\nconst MY_THEME = {\n  bg: "oklch(12% 0.02 280)",\n  c1: "oklch(55% 0.25 295)", // Primary color\n  c2: "oklch(65% 0.18 230)", // Secondary color\n  c3: "oklch(70% 0.15 200)", // Accent color\n};\n\n// Use in your visualizer\n<AudioReactiveSiriOrb\n  theme="sphere"  // or pass custom colors\n  size={sphereSize}\n  audioLevel={audioLevel}\n  isRemoteSpeaking={isRemoteSpeaking}\n/>\n'})}),"\n",(0,t.jsx)(i.h2,{id:"existing-visualizers-reference",children:"Existing Visualizers Reference"}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Visualizer"}),(0,t.jsx)(i.th,{children:"Description"}),(0,t.jsx)(i.th,{children:"Key Features"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"StellaFace"})}),(0,t.jsx)(i.td,{children:"Animated SVG face"}),(0,t.jsx)(i.td,{children:"Eye tracking, mouth animation, emotions"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"SphereVisualizer"})}),(0,t.jsx)(i.td,{children:"Glowing gradient orb"}),(0,t.jsx)(i.td,{children:"Audio-reactive glow and scale"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"WeatherVisualizer"})}),(0,t.jsx)(i.td,{children:"Themed particle effects"}),(0,t.jsx)(i.td,{children:"Galaxy stars, rain, snow, sun rays"})]})]})]}),"\n",(0,t.jsxs)(i.p,{children:["Review these implementations in ",(0,t.jsx)(i.code,{children:"frontend-ui/src/components/face/"})," for inspiration."]}),"\n",(0,t.jsx)(i.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.a,{href:"/docs/integration/livekit",children:"LiveKit Integration"})," - How audio data flows to visualizers"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.a,{href:"/docs/architecture/overview",children:"Architecture Overview"})," - System architecture"]}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}}}]);