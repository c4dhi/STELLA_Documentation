"use strict";(globalThis.webpackChunkdocs_site=globalThis.webpackChunkdocs_site||[]).push([[1218],{8453(e,n,s){s.d(n,{R:()=>l,x:()=>d});var i=s(6540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}},9352(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"agents/stella-agent/configuration","title":"Configuration","description":"Each expert is defined by a JSON configuration file. This page covers the configuration schema and expert selection logic.","source":"@site/docs/agents/stella-agent/configuration.md","sourceDirName":"agents/stella-agent","slug":"/agents/stella-agent/configuration","permalink":"/STELLA_backend/docs/agents/stella-agent/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/c4dhi/STELLA_backend/tree/main/docs-site/docs/agents/stella-agent/configuration.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Configuration"},"sidebar":"docsSidebar","previous":{"title":"Default Experts","permalink":"/STELLA_backend/docs/agents/stella-agent/default-experts"},"next":{"title":"Custom Experts","permalink":"/STELLA_backend/docs/agents/stella-agent/custom-experts"}}');var r=s(4848),t=s(8453);const l={sidebar_position:3,title:"Configuration"},d="Expert Configuration",c={},o=[{value:"Configuration Schema",id:"configuration-schema",level:2},{value:"Field Descriptions",id:"field-descriptions",level:2},{value:"Required Fields",id:"required-fields",level:3},{value:"Optional Fields",id:"optional-fields",level:3},{value:"Expert Selection Logic",id:"expert-selection-logic",level:2},{value:"Selection Process",id:"selection-process",level:3},{value:"Selection Code",id:"selection-code",level:3},{value:"Risk Score Calculation",id:"risk-score-calculation",level:2},{value:"Risk Score Examples",id:"risk-score-examples",level:3},{value:"ExpertResult Schema",id:"expertresult-schema",level:2},{value:"Aggregator Synthesis",id:"aggregator-synthesis",level:2},{value:"1. Conflict Analysis",id:"1-conflict-analysis",level:3},{value:"2. Consensus Detection",id:"2-consensus-detection",level:3},{value:"3. Confidence Scoring",id:"3-confidence-scoring",level:3},{value:"4. Response Synthesis Guidelines",id:"4-response-synthesis-guidelines",level:3},{value:"Next Steps",id:"next-steps",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"expert-configuration",children:"Expert Configuration"})}),"\n",(0,r.jsx)(n.p,{children:"Each expert is defined by a JSON configuration file. This page covers the configuration schema and expert selection logic."}),"\n",(0,r.jsx)(n.h2,{id:"configuration-schema",children:"Configuration Schema"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"AgentConfig"})," dataclass defines the structure for expert configurations:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'@dataclass\nclass AgentConfig:\n    name: str                           # Unique identifier\n    description: str                    # What this expert analyzes\n    trigger_keywords: List[str]         # Semantic triggers\n    system_prompt: str                  # Expert\'s instructions\n    model: str = "gpt-4o-mini"          # LLM model\n    temperature: float = 0.3            # Response creativity\n    max_tokens: int = 800               # Response length limit\n    risk_threshold: float = 0.3         # Min risk score to activate\n    relevant_intents: List[str] = []    # Intent types to respond to\n    tools: List[str] = []               # Available tools\n    always_active: bool = False         # Bypass selection logic\n'})}),"\n",(0,r.jsx)(n.h2,{id:"field-descriptions",children:"Field Descriptions"}),"\n",(0,r.jsx)(n.h3,{id:"required-fields",children:"Required Fields"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"name"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"str"})}),(0,r.jsx)(n.td,{children:'Unique identifier for the expert (e.g., "medical", "legal")'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"description"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"str"})}),(0,r.jsx)(n.td,{children:"Human-readable description of what this expert analyzes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"trigger_keywords"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"List[str]"})}),(0,r.jsx)(n.td,{children:"Keywords that trigger this expert (semantic, not exact match)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"system_prompt"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"str"})}),(0,r.jsx)(n.td,{children:"Instructions that define expert behavior and response format"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"optional-fields",children:"Optional Fields"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Default"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"model"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"str"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"gpt-4o-mini"'})}),(0,r.jsx)(n.td,{children:"LLM model to use for analysis"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"temperature"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"float"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"0.3"})}),(0,r.jsx)(n.td,{children:"Response creativity (0.0-1.0, lower = more consistent)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"max_tokens"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"int"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"800"})}),(0,r.jsx)(n.td,{children:"Maximum response length"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"risk_threshold"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"float"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"0.3"})}),(0,r.jsx)(n.td,{children:"Minimum risk score to activate (0.0-1.0)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"relevant_intents"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"List[str]"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"[]"})}),(0,r.jsx)(n.td,{children:'Intent types to respond to (e.g., "question", "request")'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tools"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"List[str]"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"[]"})}),(0,r.jsx)(n.td,{children:"Tool names available to this expert"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"always_active"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bool"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"false"})}),(0,r.jsx)(n.td,{children:"If true, runs on every query"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"expert-selection-logic",children:"Expert Selection Logic"}),"\n",(0,r.jsx)(n.p,{children:"The ExpertPool uses a multi-factor approach to select which experts analyze each query:"}),"\n",(0,r.jsx)(n.h3,{id:"selection-process",children:"Selection Process"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  EXPERT SELECTION                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                          \u2502\n\u2502   1. Always-Active Check                                 \u2502\n\u2502      \u2514\u2500\u25ba Experts with always_active: true               \u2502\n\u2502          (e.g., Timekeeper) run on EVERY query          \u2502\n\u2502                                                          \u2502\n\u2502   2. Keyword Matching                                    \u2502\n\u2502      \u2514\u2500\u25ba Check if any trigger_keywords appear           \u2502\n\u2502          in the user input (case-insensitive)           \u2502\n\u2502                                                          \u2502\n\u2502   3. Risk Score Comparison                               \u2502\n\u2502      \u2514\u2500\u25ba If content risk_score > expert.risk_threshold  \u2502\n\u2502          then expert is selected                         \u2502\n\u2502                                                          \u2502\n\u2502   4. Intent Matching                                     \u2502\n\u2502      \u2514\u2500\u25ba If user intent matches relevant_intents        \u2502\n\u2502          then expert is selected                         \u2502\n\u2502                                                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(n.h3,{id:"selection-code",children:"Selection Code"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'def should_analyze(self, user_input: str, intent: str, risk_score: float) -> bool:\n    """Determine if this agent should analyze the input."""\n    user_lower = user_input.lower()\n\n    # Check keywords\n    if any(keyword in user_lower for keyword in self.config.trigger_keywords):\n        return True\n\n    # Check risk threshold\n    if risk_score > self.config.risk_threshold:\n        return True\n\n    # Check intent matching\n    if self.config.relevant_intents and intent in self.config.relevant_intents:\n        return True\n\n    return False\n'})}),"\n",(0,r.jsx)(n.h2,{id:"risk-score-calculation",children:"Risk Score Calculation"}),"\n",(0,r.jsx)(n.p,{children:"The ExpertPool calculates a risk score for each query using keyword-based heuristics:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'def _quick_analysis(self, user_input: str) -> tuple:\n    user_lower = user_input.lower()\n    risk_score = 0.0\n\n    # Medical keywords add highest risk\n    if any(word in user_lower for word in ["medical", "health", "doctor"]):\n        risk_score += 0.4\n\n    # Legal keywords add moderate-high risk\n    if any(word in user_lower for word in ["legal", "law", "lawyer"]):\n        risk_score += 0.3\n\n    # Financial keywords add moderate risk\n    if any(word in user_lower for word in ["invest", "money", "financial"]):\n        risk_score += 0.2\n\n    return intent, min(risk_score, 1.0)  # Cap at 1.0\n'})}),"\n",(0,r.jsx)(n.h3,{id:"risk-score-examples",children:"Risk Score Examples"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Query"}),(0,r.jsx)(n.th,{children:"Risk Score"}),(0,r.jsx)(n.th,{children:"Experts Triggered"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:'"Hello, how are you?"'}),(0,r.jsx)(n.td,{children:"0.0"}),(0,r.jsx)(n.td,{children:"Timekeeper only"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:'"I have a headache"'}),(0,r.jsx)(n.td,{children:"0.4"}),(0,r.jsx)(n.td,{children:"Medical, Timekeeper"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:'"Can I sue my landlord?"'}),(0,r.jsx)(n.td,{children:"0.3"}),(0,r.jsx)(n.td,{children:"Legal, Timekeeper"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:'"Should I invest in crypto?"'}),(0,r.jsx)(n.td,{children:"0.2"}),(0,r.jsx)(n.td,{children:"Finance, Timekeeper"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:'"My doctor says I need medicine for legal reasons"'}),(0,r.jsx)(n.td,{children:"0.7"}),(0,r.jsx)(n.td,{children:"Medical, Legal, Timekeeper"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"expertresult-schema",children:"ExpertResult Schema"}),"\n",(0,r.jsxs)(n.p,{children:["Expert output is captured in the ",(0,r.jsx)(n.code,{children:"ExpertResult"})," dataclass:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'@dataclass\nclass ExpertResult:\n    agent_name: str                          # Which expert produced this\n    success: bool                            # Did analysis succeed?\n    findings: str = ""                       # Analysis content\n    risks: List[str] = field(default_factory=list)  # Identified risks\n    recommendation: str = ""                 # Guidance for aggregator\n    confidence: float = 0.5                  # Confidence in findings (0.0-1.0)\n    raw_response: str = ""                   # Full LLM response\n    error_type: Optional[str] = None         # Error category if failed\n    error_message: Optional[str] = None      # Error details if failed\n    metadata: Dict[str, Any] = field(default_factory=dict)  # Extra data\n'})}),"\n",(0,r.jsx)(n.h2,{id:"aggregator-synthesis",children:"Aggregator Synthesis"}),"\n",(0,r.jsx)(n.p,{children:"The Aggregator combines expert findings using these steps:"}),"\n",(0,r.jsx)(n.h3,{id:"1-conflict-analysis",children:"1. Conflict Analysis"}),"\n",(0,r.jsx)(n.p,{children:"Identifies disagreements between experts:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Risk disagreements (some experts found risks, others didn't)"}),"\n",(0,r.jsx)(n.li,{children:"Recommendation conflicts (multiple different recommendations)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-consensus-detection",children:"2. Consensus Detection"}),"\n",(0,r.jsx)(n.p,{children:"Finds common ground across findings:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Shared keywords (safe, proceed, caution, recommend, avoid)"}),"\n",(0,r.jsx)(n.li,{children:"Agreement on risk level"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-confidence-scoring",children:"3. Confidence Scoring"}),"\n",(0,r.jsx)(n.p,{children:"Calculates overall confidence:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"def _calculate_confidence(self, expert_results, conflict_analysis) -> float:\n    # Average expert confidence\n    avg_confidence = sum(r.confidence for r in successful) / len(successful)\n\n    # Penalty for conflicts\n    conflict_penalty = min(0.3, len(conflicts) * 0.1)\n\n    # Penalty for failures\n    failure_penalty = failure_rate * 0.2\n\n    return max(0.0, min(1.0, avg_confidence - conflict_penalty - failure_penalty))\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-response-synthesis-guidelines",children:"4. Response Synthesis Guidelines"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Responses target ~30-50 words"}),"\n",(0,r.jsx)(n.li,{children:"Acknowledges user's interest without dwelling on issues"}),"\n",(0,r.jsx)(n.li,{children:"Provides relevant guidance based on expert analysis"}),"\n",(0,r.jsx)(n.li,{children:"Gently redirects potentially problematic conversations"}),"\n",(0,r.jsx)(n.li,{children:"Maintains helpful, supportive tone"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"custom-experts",children:"Custom Experts"})," - Learn how to add and modify experts"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/plan-structure",children:"Plan Structure"})," - Learn how to configure conversation flows with Plans"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);